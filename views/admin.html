<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.22/css/dataTables.bootstrap4.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/10.6.1/sweetalert2.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.5.3/umd/popper.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.22/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.22/js/dataTables.bootstrap4.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/10.6.1/sweetalert2.min.js"></script>

    <!-- <script>
        var tableUser
        $(document).ready(function () {
            tableUser = $("#myTable").DataTable({
                ajax: {
                    url: "/users",
                    dataSrc: function(data){
                        for(let row=0; row<data.length;row++){
                            if(data[row].role == 1) {
                                data[row].role = "Admin";
                            }
                            else{
                                data[row].role = "User";
                            }
                        }
                        return data;
                    },
                },
                columns : [
                    {data: "id", title: "ID"},
                    {data: "username" ,title: "Name"},
                    {data: "role" ,title: "Role"},
                    {title: "Action", defaultContent: "<button class='btn btn-danger btn-delete'>Delete</button> <button class='btn btn-warning' btn-edit>Edit</button>"}
                ] 
            });

            $("#myTable tbody").on("click", ".btn-delete", function(){
                // alert("delete");
                const currentRow = $(this).parents("tr");
                const data = tableUser.row(currentRow).data();
                //alert(data.id);
                Swal.fire({
                    title: "Delete " + data.username + " ? ",
                    showCancelButton: true, 
                    confirmButtonText: "Yes",
                }).then(function(result){
                    if(result.isConfirmed){
                        // delete user
                        deleteUser(data.id , currentRow);
                    }
                });
            });
        });
        function deleteUser(id , currentRow){
            //alert(id);
            $.ajax({
                    method: "DELETE",
                    url: "/user/" + id,
                }).done(function(data, state, xhr){
                    Swal.fire(data);
                    // update table
                    // window.location.reload();
                    tableUser.row(currentRow).remove().draw(false);
                }).fail(function(xhr, state){
                    Swal.fire(xhr.responseText);
                });
        };
    </script> -->
</head>
<body>
    <div class="container">
        <h1>Admin Page</h1>
        <button class="btn btn-dark">Log out</button>
        <button class="btn btn-success">Add</button>

        <table id="myTable" class="table table-striped table-bordered" style="width: 100%;"></table>
    </div>
</body>
</html>